df <- df[,c(
"Date", "Condition",
"COD_in", "PO4P_in", "NH4N_in", "NO3N_in", "DO_in",
"MLSS", "MLVSS",
"COD_out", "PO4P_out", "NH4N_out", "NO3N_out", "DO_out"
)]
# df$Nutrients_in
df$Nutrients_in <- df$NH4N_in + df$NO3N_in + df$PO4P_in
Y <- df[,c("COD_out", "PO4P_out", "NH4N_out", "NO3N_out", "DO_out")]
Y <- as.matrix(Y)
X <- df[,c("COD_in", "Nutrients_in", "DO_in", "MLVSS")]
mvlm.res <- mvlm(Y~.^2, data = X)
summary(mvlm.res)
mvlm.res$y.rsq #is proportion (1st row as relative, others are absolute)
mvlm.res$beta.hat
# write.csv(mvlm.res$beta.hat, file = 'beta.csv')
Res <- residuals(mvlm.res)
psych::describe(Res)
apply(na.omit(Res), MARGIN = 2, norm, type = '2')/nrow(Res)
# rm(Y, X, Res)
# rm(mvlm.res)
}
mvlm
mvlm.res
predict(mvlm.res)
predict(mvlm.res, rep(1,3))
predict(mvlm.res, rep(5,3))
predict(mvlm.res, rep(5,4))
X
predict(mvlm.res, matrix(rep(5,4), ncol = 4))
summary(mvlm.res)
if(1){
# Steady State Only, w/ wo condition 6
df <- MBR_Yasmeen[which(MBR_Yasmeen$SteadyStateIndicator==1),]
df <- df[which(df$Condition!=6),]
# Sort Columns
df <- df[,c(
"Date", "Condition",
"COD_in", "PO4P_in", "NH4N_in", "NO3N_in", "DO_in",
"MLSS", "MLVSS",
"COD_out", "PO4P_out", "NH4N_out", "NO3N_out", "DO_out"
)]
# df$Nutrients_in
df$Nutrients_in <- df$NH4N_in + df$NO3N_in + df$PO4P_in
Y <- df[,c("COD_out", "PO4P_out", "NH4N_out", "NO3N_out", "DO_out")]
Y <- as.matrix(Y)
# X <- df[,c("COD_in", "Nutrients_in", "DO_in", "MLVSS")]
X <- df[,c("COD_in", "Nutrients_in", "DO_in")]
mvlm.res <- mvlm(Y~.^2, data = X)
summary(mvlm.res)
mvlm.res$y.rsq #is proportion (1st row as relative, others are absolute)
mvlm.res$beta.hat
# write.csv(mvlm.res$beta.hat, file = 'beta.csv')
Res <- residuals(mvlm.res)
psych::describe(Res)
apply(na.omit(Res), MARGIN = 2, norm, type = '2')/nrow(Res)
# rm(Y, X, Res)
# rm(mvlm.res)
}
mvlm.res$y.rsq #is proportion (1st row as relative, others are absolute)
mvlm.res$beta.hat
Res
psych::describe(Res)
apply(na.omit(Res), MARGIN = 2, norm, type = '2')/nrow(Res)
mvlm.res
predict(mvlm.res, newdata = rep(1,4))
predict(mvlm.res, newdata = rep(1,3))
predict(mvlm.res, newdata = X)
X
dim(X)
head(X)
# Sensitivity Analysis of MVLM --------------------------------------------
expand.grid(
COD_in = 100:500,
Nutrients_in = 15:30,
DO_in = 0:10
)
# Sensitivity Analysis of MVLM --------------------------------------------
X_predict <- expand.grid(
COD_in = 100:500,
Nutrients_in = 15:30,
DO_in = 0:10
)
head(X_predict)
View(X_predict)
dim(X_predict)
Y_predict <- predict(mvlm.res, X_predict)
head(Y_predict)
View(Y_predict)
head(X_predict)
# Sensitivity Analysis of MVLM --------------------------------------------
X_predict <- expand.grid(
COD_in = 100:450,
Nutrients_in = 15:35,
DO_in = 0:10
)
Y_predict <- predict(mvlm.res, X_predict)
colSums(Y_predict<0)
rowsum(Y_predict<0)
rowSums(Y_predict<0)
colSums(Y_predict<0)
dim(X_predict)
# Sensitivity Analysis of MVLM --------------------------------------------
X_predict <- expand.grid(
COD_in = seq(from = 100, to = 400, by = 50),
Nutrients_in = seq(from = 15, to = 35, by = 5),
DO_in = seq(from = 0, to = 8, by = 2)
)
Y_predict <- predict(mvlm.res, X_predict)
Y_predict
Y_predict %>% head
X_predict %>% head
# Sensitivity Analysis of MVLM --------------------------------------------
X_predict <-
rbind(
expand.grid(
COD_in = seq(from = 380, to = 420, by = 2),
Nutrients_in = seq(from = 30, to = 40, by = 1),
DO_in = seq(from = 0, to = 2, by = .1)
),
expand.grid(
COD_in = seq(from = 280, to = 320, by = 2),
Nutrients_in = seq(from = 20, to = 30, by = 1),
DO_in = seq(from = 2, to = 4, by = .1)
),
expand.grid(
COD_in = seq(from = 180, to = 220, by = 2),
Nutrients_in = seq(from = 15, to = 25, by = 1),
DO_in = seq(from = 6, to = 8, by = .1)
),
expand.grid(
COD_in = seq(from = 80, to = 120, by = 2),
Nutrients_in = seq(from = 15, to = 25, by = 1),
DO_in = seq(from = 6, to = 8, by = .1)
),
expand.grid(
COD_in = seq(from = 140, to = 170, by = 2),
Nutrients_in = seq(from = 20, to = 30, by = 1),
DO_in = seq(from = 2, to = 4, by = .1)
)
)
Y_predict <- predict(mvlm.res, X_predict)
View(Y_predict)
colSums(Y_predict<0)
X_predict[Y_predict<0,]
X_predict[Y_predict<0]
(Y_predict<0)
rowSums(Y_predict<0)
rowSums(Y_predict<0)>0
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0]
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0]
]
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
]
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
] %>% View
# Sensitivity Analysis of MVLM --------------------------------------------
X_predict <-
rbind(
expand.grid(
COD_in = seq(from = 380, to = 420, by = 2),
Nutrients_in = seq(from = 30, to = 40, by = 1),
DO_in = seq(from = 0, to = 1, by = .1)
),
expand.grid(
COD_in = seq(from = 280, to = 320, by = 2),
Nutrients_in = seq(from = 20, to = 30, by = 1),
DO_in = seq(from = 3, to = 4, by = .1)
),
expand.grid(
COD_in = seq(from = 180, to = 220, by = 2),
Nutrients_in = seq(from = 15, to = 25, by = 1),
DO_in = seq(from = 6, to = 7, by = .1)
),
expand.grid(
COD_in = seq(from = 80, to = 120, by = 2),
Nutrients_in = seq(from = 15, to = 25, by = 1),
DO_in = seq(from = 6, to = 7, by = .1)
),
expand.grid(
COD_in = seq(from = 140, to = 170, by = 2),
Nutrients_in = seq(from = 20, to = 30, by = 1),
DO_in = seq(from = 3, to = 4, by = .1)
)
)
Y_predict <- predict(mvlm.res, X_predict)
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
]
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
] %>% View
dim(X_predict)
dim(Y_predict)
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
] %>% dim
# Sensitivity Analysis of MVLM --------------------------------------------
X_predict <-
rbind(
expand.grid(
COD_in = seq(from = 390, to = 410, by = 2),
Nutrients_in = seq(from = 30, to = 40, by = 1),
DO_in = seq(from = 0, to = 1, by = .1)
),
expand.grid(
COD_in = seq(from = 290, to = 310, by = 2),
Nutrients_in = seq(from = 20, to = 30, by = 1),
DO_in = seq(from = 3, to = 4, by = .1)
),
expand.grid(
COD_in = seq(from = 190, to = 210, by = 2),
Nutrients_in = seq(from = 15, to = 25, by = 1),
DO_in = seq(from = 6, to = 7, by = .1)
),
expand.grid(
COD_in = seq(from = 90, to = 110, by = 2),
Nutrients_in = seq(from = 15, to = 25, by = 1),
DO_in = seq(from = 6, to = 7, by = .1)
),
expand.grid(
COD_in = seq(from = 140, to = 160, by = 2),
Nutrients_in = seq(from = 20, to = 30, by = 1),
DO_in = seq(from = 3, to = 4, by = .1)
)
)
Y_predict <- predict(mvlm.res, X_predict)
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
]
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
] %>% View
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
] %>% dim
# Sensitivity Analysis of MVLM --------------------------------------------
X_predict <-
rbind(
expand.grid(
COD_in = seq(from = 390, to = 410, by = 2),
Nutrients_in = seq(from = 32, to = 38, by = .5),
DO_in = seq(from = 0, to = 1, by = .1)
),
expand.grid(
COD_in = seq(from = 290, to = 310, by = 2),
Nutrients_in = seq(from = 23, to = 29, by = .5),
DO_in = seq(from = 3, to = 4, by = .1)
),
expand.grid(
COD_in = seq(from = 190, to = 210, by = 2),
Nutrients_in = seq(from = 15, to = 21, by = .5),
DO_in = seq(from = 6, to = 7, by = .1)
),
expand.grid(
COD_in = seq(from = 90, to = 110, by = 2),
Nutrients_in = seq(from = 14, to = 20, by = .5),
DO_in = seq(from = 6, to = 7, by = .1)
),
expand.grid(
COD_in = seq(from = 140, to = 160, by = 2),
Nutrients_in = seq(from = 23, to = 29, by = .5),
DO_in = seq(from = 3, to = 4, by = .1)
)
)
Y_predict <- predict(mvlm.res, X_predict)
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
]
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
] %>% dim
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
] %>% View
dim(X_predict)
# Sensitivity Analysis of MVLM --------------------------------------------
X_predict <-
rbind(
expand.grid(
COD_in = seq(from = 390, to = 410, by = 2),
Nutrients_in = seq(from = 32, to = 37, by = .5),
DO_in = seq(from = 0, to = 1, by = .1)
),
expand.grid(
COD_in = seq(from = 290, to = 310, by = 2),
Nutrients_in = seq(from = 23, to = 28, by = .5),
DO_in = seq(from = 3, to = 4, by = .1)
),
expand.grid(
COD_in = seq(from = 190, to = 210, by = 2),
Nutrients_in = seq(from = 15, to = 20, by = .5),
DO_in = seq(from = 6, to = 7, by = .1)
),
expand.grid(
COD_in = seq(from = 90, to = 110, by = 2),
Nutrients_in = seq(from = 14, to = 19, by = .5),
DO_in = seq(from = 6, to = 7, by = .1)
),
expand.grid(
COD_in = seq(from = 140, to = 160, by = 2),
Nutrients_in = seq(from = 23, to = 28, by = .5),
DO_in = seq(from = 3, to = 4, by = .1)
)
)
Y_predict <- predict(mvlm.res, X_predict)
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
]
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
] %>% dim()
dim(X_predict)
# Sensitivity Analysis of MVLM --------------------------------------------
X_predict <-
rbind(
expand.grid(
COD_in = seq(from = 390, to = 410, by = 2),
Nutrients_in = seq(from = 32, to = 38, by = .5),
DO_in = seq(from = 0, to = .5, by = .1)
),
expand.grid(
COD_in = seq(from = 290, to = 310, by = 2),
Nutrients_in = seq(from = 23, to = 29, by = .5),
DO_in = seq(from = 3.2, to = 3.7, by = .1)
),
expand.grid(
COD_in = seq(from = 190, to = 210, by = 2),
Nutrients_in = seq(from = 15, to = 21, by = .5),
DO_in = seq(from = 6.5, to = 7, by = .1)
),
expand.grid(
COD_in = seq(from = 90, to = 110, by = 2),
Nutrients_in = seq(from = 14, to = 20, by = .5),
DO_in = seq(from = 6.5, to = 7, by = .1)
),
expand.grid(
COD_in = seq(from = 140, to = 160, by = 2),
Nutrients_in = seq(from = 23, to = 29, by = .5),
DO_in = seq(from = 3.2, to = 3.7, by = .1)
)
)
Y_predict <- predict(mvlm.res, X_predict)
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
]
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
] %>% View
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0]
Y_predict[rowSums(Y_predict<0)>0]
Y_predict[rowSums(Y_predict<0)>0,]
Y_predict[rowSums(Y_predict<0)>0,] %>% View
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
]
# Sensitivity Analysis of MVLM --------------------------------------------
X_predict <-
rbind(
expand.grid(
COD_in = seq(from = 390, to = 410, by = 2),
Nutrients_in = seq(from = 32, to = 38, by = .5),
DO_in = seq(from = 0, to = .5, by = .1)
),
expand.grid(
COD_in = seq(from = 290, to = 310, by = 2),
Nutrients_in = seq(from = 23, to = 29, by = .5),
DO_in = seq(from = 3.2, to = 3.7, by = .1)
),
expand.grid(
COD_in = seq(from = 190, to = 210, by = 2),
Nutrients_in = seq(from = 15, to = 21, by = .5),
DO_in = seq(from = 6.5, to = 7, by = .1)
),
expand.grid(
COD_in = seq(from = 90, to = 110, by = 2),
Nutrients_in = seq(from = 14, to = 20, by = .5),
DO_in = seq(from = 6.5, to = 7, by = .1)
),
expand.grid(
COD_in = seq(from = 150, to = 170, by = 2),
Nutrients_in = seq(from = 23, to = 29, by = .5),
DO_in = seq(from = 3.2, to = 3.7, by = .1)
)
)
Y_predict <- predict(mvlm.res, X_predict)
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
]
# Sensitivity Analysis of MVLM --------------------------------------------
X_predict <-
rbind(
expand.grid(
COD_in = seq(from = 390, to = 410, by = 2),
Nutrients_in = seq(from = 32, to = 38, by = .5),
DO_in = seq(from = 0, to = .5, by = .1)
),
expand.grid(
COD_in = seq(from = 290, to = 310, by = 2),
Nutrients_in = seq(from = 23, to = 29, by = .5),
DO_in = seq(from = 3.2, to = 3.7, by = .1)
),
expand.grid(
COD_in = seq(from = 190, to = 210, by = 2),
Nutrients_in = seq(from = 15, to = 20, by = .5),
DO_in = seq(from = 6.5, to = 7, by = .1)
),
expand.grid(
COD_in = seq(from = 90, to = 110, by = 2),
Nutrients_in = seq(from = 15, to = 20, by = .5),
DO_in = seq(from = 6.5, to = 7, by = .1)
),
expand.grid(
COD_in = seq(from = 150, to = 170, by = 2),
Nutrients_in = seq(from = 23, to = 29, by = .5),
DO_in = seq(from = 3.2, to = 3.7, by = .1)
)
)
Y_predict <- predict(mvlm.res, X_predict)
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
]
Y_predict[rowSums(Y_predict<0)>0,]
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
]
# Sensitivity Analysis of MVLM --------------------------------------------
X_predict <-
rbind(
expand.grid(
COD_in = seq(from = 390, to = 410, by = 2),
Nutrients_in = seq(from = 32, to = 37, by = .5),
DO_in = seq(from = 0, to = .5, by = .1)
),
expand.grid(
COD_in = seq(from = 290, to = 310, by = 2),
Nutrients_in = seq(from = 23, to = 28, by = .5),
DO_in = seq(from = 3.2, to = 3.7, by = .1)
),
expand.grid(
COD_in = seq(from = 190, to = 210, by = 2),
Nutrients_in = seq(from = 15, to = 20, by = .5),
DO_in = seq(from = 6.5, to = 7, by = .1)
),
expand.grid(
COD_in = seq(from = 90, to = 110, by = 2),
Nutrients_in = seq(from = 15, to = 20, by = .5),
DO_in = seq(from = 6.5, to = 7, by = .1)
),
expand.grid(
COD_in = seq(from = 150, to = 170, by = 2),
Nutrients_in = seq(from = 23, to = 29, by = .5),
DO_in = seq(from = 3.2, to = 3.7, by = .1)
)
)
Y_predict <- predict(mvlm.res, X_predict)
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
]
Y_predict[rowSums(Y_predict<0)>0,]
clipr::write_clip(X_predict)
clipr::write_clip(Y_predict)
expand.grid(
COD_in = seq(from = 390, to = 410, by = 2),
Nutrients_in = seq(from = 32, to = 37, by = .5),
DO_in = seq(from = 0, to = .5, by = .1)
) %>% dim
726*5+1
3763/5
# Sensitivity Analysis of MVLM --------------------------------------------
X_predict <-
rbind(
expand.grid(
COD_in = seq(from = 390, to = 410, by = 2),
Nutrients_in = seq(from = 32, to = 37, by = .5),
DO_in = seq(from = 0, to = .5, by = .1)
),
expand.grid(
COD_in = seq(from = 290, to = 310, by = 2),
Nutrients_in = seq(from = 23, to = 28, by = .5),
DO_in = seq(from = 3.2, to = 3.7, by = .1)
),
expand.grid(
COD_in = seq(from = 190, to = 210, by = 2),
Nutrients_in = seq(from = 15, to = 20, by = .5),
DO_in = seq(from = 6.5, to = 7, by = .1)
),
expand.grid(
COD_in = seq(from = 90, to = 110, by = 2),
Nutrients_in = seq(from = 15, to = 20, by = .5),
DO_in = seq(from = 6.5, to = 7, by = .1)
),
expand.grid(
COD_in = seq(from = 150, to = 170, by = 2),
Nutrients_in = seq(from = 23, to = 28, by = .5),
DO_in = seq(from = 3.2, to = 3.7, by = .1)
)
)
Y_predict <- predict(mvlm.res, X_predict)
X_predict[
seq_len(nrow(Y_predict))[rowSums(Y_predict<0)>0],
]
clipr::write_clip(X_predict)
clipr::write_clip(Y_predict)
726*5+1
726
726*2+1
726*3+1
726*4+1
