geom_vline(xintercept = c(3.5)) +
# ggtitle('From_WQin_To_Phylum_Complete, with Deinococcus.Thermus') +
ggtitle(
'Estimated effect of influent water quality on phylum abundance'
) +
xlab('Parameters') +
ylab('Estimated Values') +
scale_y_continuous(
limits = c(-.4,.4),
breaks = seq(from = -.4, to = .4, by = .1),
minor_breaks = seq(from = -.4, to = .4, by = .05)
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
)
dim(result_mn_in_Phylum_out)
dim(result_mn_in_Phylum_out$mcmc)
dim(result_mn_in_Phylum_out$mcmc[[1]])
#
print(
ggplot(data = dfm,
aes(x = variable, y = value, group = index)) +
geom_line(alpha = .1) +
geom_point(alpha = .1) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
geom_vline(xintercept = seq(from = 0, to = 28, by = 4) + .5,
linetype = 'dashed', color = 'black') +
# ggtitle('From_WQin_To_Phylum_Complete, with Deinococcus.Thermus') +
ggtitle(
'Estimated effect of influent water quality on phylum abundance'
) +
xlab('Parameters') +
ylab('Estimated Values') +
scale_y_continuous(
limits = c(-.4,.4),
breaks = seq(from = -.4, to = .4, by = .1),
minor_breaks = seq(from = -.4, to = .4, by = .05)
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
)
#
print(
ggplot(data = dfm,
aes(x = variable, y = value, group = index)) +
geom_line(alpha = .13) +
geom_point(alpha = .13) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
geom_vline(xintercept = seq(from = 0, to = 28, by = 4) + .5,
linetype = 'dashed', color = 'black') +
# ggtitle('From_WQin_To_Phylum_Complete, with Deinococcus.Thermus') +
ggtitle(
'Estimated effect of influent water quality on phylum abundance'
) +
xlab('Parameters') +
ylab('Estimated Values') +
scale_y_continuous(
limits = c(-.4,.4),
breaks = seq(from = -.4, to = .4, by = .1),
minor_breaks = seq(from = -.4, to = .4, by = .05)
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
)
#
ggplot(data = dfm,
aes(x = variable, y = value, group = index)) +
geom_line(alpha = .1) +
geom_point(alpha = .1) +
ggtitle('From_Phylum_To_WQout, with Deinococcus.Thermus') +
# ggtitle('From_WQin_To_Phylum, without Deinococcus.Thermus') +
xlab('Parameters') +
ylab('Estimated Values') +
theme_bw() +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
# 4. Parallel_Coordinates, Complete --------------------------------
# 1) to WQ_out from Phylum, Complete
# 2) to Phylum from WQ_in, Complete
if(1){
# # # # # # # # # # # # # # # # # # # # # # # # #
# Contribution to WQ_out from Phylum, complete  #
# # # # # # # # # # # # # # # # # # # # # # # # #
#
# melt
dfm <- data.frame(
index = rownames(result_mn_in_Phylum_out$mcmc[[1]]),
result_mn_in_Phylum_out$mcmc[[1]])
# Only look at beta_out
dfm <- cbind(dfm$index, select(dfm, starts_with('beta_out')))
# Phylum Sequence, length K
p_seq <- gsub("^.*_", "",
colnames(Phylum_WQ_io)[(4+J_1+J_2):(4+J_1+J_2+K-1)])
# WQ_in, length J_1
j_1_seq <- colnames(Phylum_WQ_io)[4:(4+J_1-1)]
j_2_seq <- colnames(Phylum_WQ_io)[(4+J_1):(4+J_1+J_2-1)]
colnames(dfm)[1:(1+K*J_1)] <- c('index',
paste(rep(p_seq, J_1),
rep(j_2_seq, each = K),
sep = '_'))
# Ignore "Deinococcus.Thermus"
dfm <- select(dfm, - starts_with(p_seq[4]))
# Sort by Phylum
if(0){dfm <- dfm[,sort(colnames(dfm))]}
# subsample, for plotting
dfm <- dfm[sample(NROW(dfm), size = NROW(dfm)/1), ]
dfm <- reshape2::melt(dfm, id.var = 'index')
#
ggplot(data = dfm,
aes(x = variable, y = value, group = index)) +
geom_line(alpha = .1) +
geom_point(alpha = .1) +
ggtitle('From_Phylum_To_WQout, with Deinococcus.Thermus') +
# ggtitle('From_WQin_To_Phylum, without Deinococcus.Thermus') +
xlab('Parameters') +
ylab('Estimated Values') +
theme_bw() +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
# scale_y_continuous(
#     limits = c(-2,2),
#     breaks = seq(-3, 3, .5), minor_breaks = seq(-2, 2, .1))
if(0){
ggsave('Effects.svg',
device = 'svg', width = 16, height = 9)
}
}
# 4. Parallel_Coordinates, Complete --------------------------------
# 1) to WQ_out from Phylum, Complete
# 2) to Phylum from WQ_in, Complete
if(1){
# # # # # # # # # # # # # # # # # # # # # # # # #
# Contribution to WQ_out from Phylum, complete  #
# # # # # # # # # # # # # # # # # # # # # # # # #
#
# melt
dfm <- data.frame(
index = rownames(result_mn_in_Phylum_out$mcmc[[1]]),
result_mn_in_Phylum_out$mcmc[[1]])
# Only look at beta_out
dfm <- cbind(dfm$index, select(dfm, starts_with('beta_out')))
# Phylum Sequence, length K
p_seq <- gsub("^.*_", "",
colnames(Phylum_WQ_io)[(4+J_1+J_2):(4+J_1+J_2+K-1)])
# WQ_in, length J_1
j_1_seq <- colnames(Phylum_WQ_io)[4:(4+J_1-1)]
j_2_seq <- colnames(Phylum_WQ_io)[(4+J_1):(4+J_1+J_2-1)]
colnames(dfm)[1:(1+K*J_1)] <- c('index',
paste(rep(p_seq, J_1),
rep(j_2_seq, each = K),
sep = '_'))
# Ignore "Deinococcus.Thermus"
dfm <- select(dfm, - starts_with(p_seq[4]))
# Sort by Phylum
if(0){dfm <- dfm[,sort(colnames(dfm))]}
# subsample, for plotting
dfm <- dfm[sample(NROW(dfm), size = NROW(dfm)/1), ]
dfm <- reshape2::melt(dfm, id.var = 'index')
#
ggplot(data = dfm,
aes(x = variable, y = value, group = index)) +
geom_line(alpha = .1) +
geom_point(alpha = .1) +
ggtitle('From_Phylum_To_WQout, with Deinococcus.Thermus') +
# ggtitle('From_WQin_To_Phylum, without Deinococcus.Thermus') +
xlab('Parameters') +
ylab('Estimated Values') +
theme_bw() +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
# scale_y_continuous(
#     limits = c(-2,2),
#     breaks = seq(-3, 3, .5), minor_breaks = seq(-2, 2, .1))
if(0){
ggsave('Effects.svg',
device = 'svg', width = 16, height = 9)
}
}
if(1){
# # # # # # # # # # # # # # # # # # # # # # # #
# Contribution to Phylum from WQ_in, complete #
# # # # # # # # # # # # # # # # # # # # # # # #
#
# melt
dfm <- data.frame(
index = rownames(result_mn_in_Phylum_out$mcmc[[1]]),
result_mn_in_Phylum_out$mcmc[[1]])
# Only look at beta_out
dfm <- cbind(dfm$index, select(dfm, starts_with('beta_in')))
# Phylum Sequence, length K
p_seq <- gsub("^.*_", "",
colnames(Phylum_WQ_io)[(4+J_1+J_2):(4+J_1+J_2+K-1)])
# WQ_in, length J_1
j_1_seq <- colnames(Phylum_WQ_io)[4:(4+J_1-1)]
j_2_seq <- colnames(Phylum_WQ_io)[(4+J_1):(4+J_1+J_2-1)]
colnames(dfm)[1:(1+K*J_1)] <- c('index',
paste(rep(p_seq, J_1),
rep(j_1_seq, each = K),
sep = '_'))
# Ignore "Deinococcus.Thermus"
dfm <- select(dfm, - starts_with(p_seq[4]))
# Sort by Phylum
if(1){dfm <- dfm[,sort(colnames(dfm))]}
# subsample, for plotting
set.seed(2019)
dfm <- dfm[sample(NROW(dfm), size = NROW(dfm)/1), ]
dfm <- reshape2::melt(dfm, id.var = 'index')
#
print(
ggplot(data = dfm,
aes(x = variable, y = value, group = index)) +
geom_line(alpha = .13) +
geom_point(alpha = .13) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
geom_vline(xintercept = seq(from = 0, to = 28, by = 4) + .5,
linetype = 'dashed', color = 'black') +
# ggtitle('From_WQin_To_Phylum_Complete, with Deinococcus.Thermus') +
ggtitle(
'Estimated effect of influent water quality on phylum abundance'
) +
xlab('Parameters') +
ylab('Estimated Values') +
scale_y_continuous(
limits = c(-.4,.4),
breaks = seq(from = -.4, to = .4, by = .1),
minor_breaks = seq(from = -.4, to = .4, by = .05)
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
)
# scale_y_continuous(
#     limits = c(-2,2),
#     breaks = seq(-3, 3, .5), minor_breaks = seq(-2, 2, .1))
if(0){
# ggsave('From_WQin_To_Phylum_Complete, with Deinococcus.Thermus.svg',
ggsave('From_WQin_To_Phylum_Complete, without Deinococcus.Thermus.svg',
device = 'svg', width = 16, height = 9)
}
}
if(1){
# # # # # # # # # # # # # # # # # # # # # # # #
# Contribution to Phylum from WQ_in, complete #
# # # # # # # # # # # # # # # # # # # # # # # #
#
# melt
dfm <- data.frame(
index = rownames(result_mn_in_Phylum_out$mcmc[[1]]),
result_mn_in_Phylum_out$mcmc[[1]])
# Only look at beta_out
dfm <- cbind(dfm$index, select(dfm, starts_with('beta_in')))
# Phylum Sequence, length K
p_seq <- gsub("^.*_", "",
colnames(Phylum_WQ_io)[(4+J_1+J_2):(4+J_1+J_2+K-1)])
# WQ_in, length J_1
j_1_seq <- colnames(Phylum_WQ_io)[4:(4+J_1-1)]
j_2_seq <- colnames(Phylum_WQ_io)[(4+J_1):(4+J_1+J_2-1)]
colnames(dfm)[1:(1+K*J_1)] <- c('index',
paste(rep(p_seq, J_1),
rep(j_1_seq, each = K),
sep = '_'))
# Ignore "Deinococcus.Thermus"
dfm <- select(dfm, - starts_with(p_seq[4]))
# Sort by Phylum
if(1){dfm <- dfm[,sort(colnames(dfm))]}
# subsample, for plotting
set.seed(2019)
dfm <- dfm[sample(NROW(dfm), size = NROW(dfm)/1), ]
dfm <- reshape2::melt(dfm, id.var = 'index')
#
print(
ggplot(data = dfm,
aes(x = variable, y = value, group = index)) +
geom_line(alpha = .13) +
geom_point(alpha = .13) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
geom_vline(xintercept = seq(from = 0, to = 28, by = 4) + .5,
linetype = 'dashed', color = 'black') +
# ggtitle('From_WQin_To_Phylum_Complete, with Deinococcus.Thermus') +
ggtitle(
'Estimated effect of influent water quality on phylum abundance'
) +
xlab('Parameters') +
ylab('Estimated Values') +
scale_y_continuous(
limits = c(-.4,.4),
breaks = seq(from = -.4, to = .4, by = .1),
minor_breaks = seq(from = -.4, to = .4, by = .05)
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
)
# scale_y_continuous(
#     limits = c(-2,2),
#     breaks = seq(-3, 3, .5), minor_breaks = seq(-2, 2, .1))
if(0){
# ggsave('From_WQin_To_Phylum_Complete, with Deinococcus.Thermus.svg',
ggsave('From_WQin_To_Phylum_Complete, without Deinococcus.Thermus.svg',
device = 'svg', width = 16, height = 9)
}
}
# 4. Parallel_Coordinates, Complete --------------------------------
# 1) to WQ_out from Phylum, Complete
# 2) to Phylum from WQ_in, Complete
if(1){
# # # # # # # # # # # # # # # # # # # # # # # # #
# Contribution to WQ_out from Phylum, complete  #
# # # # # # # # # # # # # # # # # # # # # # # # #
#
# melt
dfm <- data.frame(
index = rownames(result_mn_in_Phylum_out$mcmc[[1]]),
result_mn_in_Phylum_out$mcmc[[1]])
# Only look at beta_out
dfm <- cbind(dfm$index, select(dfm, starts_with('beta_out')))
# Phylum Sequence, length K
p_seq <- gsub("^.*_", "",
colnames(Phylum_WQ_io)[(4+J_1+J_2):(4+J_1+J_2+K-1)])
# WQ_in, length J_1
j_1_seq <- colnames(Phylum_WQ_io)[4:(4+J_1-1)]
j_2_seq <- colnames(Phylum_WQ_io)[(4+J_1):(4+J_1+J_2-1)]
colnames(dfm)[1:(1+K*J_1)] <- c('index',
paste(rep(p_seq, J_1),
rep(j_2_seq, each = K),
sep = '_'))
# Ignore "Deinococcus.Thermus"
dfm <- select(dfm, - starts_with(p_seq[4]))
# Sort by Phylum
if(0){dfm <- dfm[,sort(colnames(dfm))]}
# subsample, for plotting
dfm <- dfm[sample(NROW(dfm), size = NROW(dfm)/1), ]
dfm <- reshape2::melt(dfm, id.var = 'index')
#
ggplot(data = dfm,
aes(x = variable, y = value, group = index)) +
geom_line(alpha = .1) +
geom_point(alpha = .1) +
ggtitle('From_Phylum_To_WQout, with Deinococcus.Thermus') +
# ggtitle('From_WQin_To_Phylum, without Deinococcus.Thermus') +
xlab('Parameters') +
ylab('Estimated Values') +
theme_bw() +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
# scale_y_continuous(
#     limits = c(-2,2),
#     breaks = seq(-3, 3, .5), minor_breaks = seq(-2, 2, .1))
if(0){
ggsave('Effects.svg',
device = 'svg', width = 16, height = 9)
}
}
# 4. Parallel_Coordinates, Complete --------------------------------
# 1) to WQ_out from Phylum, Complete
# 2) to Phylum from WQ_in, Complete
if(1){
# # # # # # # # # # # # # # # # # # # # # # # # #
# Contribution to WQ_out from Phylum, complete  #
# # # # # # # # # # # # # # # # # # # # # # # # #
#
# melt
dfm <- data.frame(
index = rownames(result_mn_in_Phylum_out$mcmc[[1]]),
result_mn_in_Phylum_out$mcmc[[1]])
# Only look at beta_out
dfm <- cbind(dfm$index, select(dfm, starts_with('beta_out')))
# Phylum Sequence, length K
p_seq <- gsub("^.*_", "",
colnames(Phylum_WQ_io)[(4+J_1+J_2):(4+J_1+J_2+K-1)])
# WQ_in, length J_1
j_1_seq <- colnames(Phylum_WQ_io)[4:(4+J_1-1)]
j_2_seq <- colnames(Phylum_WQ_io)[(4+J_1):(4+J_1+J_2-1)]
colnames(dfm)[1:(1+K*J_1)] <- c('index',
paste(rep(p_seq, J_1),
rep(j_2_seq, each = K),
sep = '_'))
# Ignore "Deinococcus.Thermus"
dfm <- select(dfm, - starts_with(p_seq[4]))
# Sort by Phylum
if(0){dfm <- dfm[,sort(colnames(dfm))]}
# subsample, for plotting
dfm <- dfm[sample(NROW(dfm), size = NROW(dfm)/1), ]
dfm <- reshape2::melt(dfm, id.var = 'index')
#
print(
ggplot(data = dfm,
aes(x = variable, y = value, group = index)) +
geom_line(alpha = .1) +
geom_point(alpha = .1) +
ggtitle('From_Phylum_To_WQout, with Deinococcus.Thermus') +
# ggtitle('From_WQin_To_Phylum, without Deinococcus.Thermus') +
xlab('Parameters') +
ylab('Estimated Values') +
theme_bw() +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
)
# scale_y_continuous(
#     limits = c(-2,2),
#     breaks = seq(-3, 3, .5), minor_breaks = seq(-2, 2, .1))
if(0){
ggsave('Effects.svg',
device = 'svg', width = 16, height = 9)
}
}
if(1){
# # # # # # # # # # # # # # # # # # # # # # # #
# Contribution to Phylum from WQ_in, complete #
# # # # # # # # # # # # # # # # # # # # # # # #
#
# melt
dfm <- data.frame(
index = rownames(result_mn_in_Phylum_out$mcmc[[1]]),
result_mn_in_Phylum_out$mcmc[[1]])
# Only look at beta_out
dfm <- cbind(dfm$index, select(dfm, starts_with('beta_in')))
# Phylum Sequence, length K
p_seq <- gsub("^.*_", "",
colnames(Phylum_WQ_io)[(4+J_1+J_2):(4+J_1+J_2+K-1)])
# WQ_in, length J_1
j_1_seq <- colnames(Phylum_WQ_io)[4:(4+J_1-1)]
j_2_seq <- colnames(Phylum_WQ_io)[(4+J_1):(4+J_1+J_2-1)]
colnames(dfm)[1:(1+K*J_1)] <- c('index',
paste(rep(p_seq, J_1),
rep(j_1_seq, each = K),
sep = '_'))
# Ignore "Deinococcus.Thermus"
dfm <- select(dfm, - starts_with(p_seq[4]))
# Sort by Phylum
if(1){dfm <- dfm[,sort(colnames(dfm))]}
# subsample, for plotting
set.seed(2019)
dfm <- dfm[sample(NROW(dfm), size = NROW(dfm)/1), ]
dfm <- reshape2::melt(dfm, id.var = 'index')
#
print(
ggplot(data = dfm,
aes(x = variable, y = value, group = index)) +
geom_line(alpha = .13) +
geom_point(alpha = .13) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
geom_vline(xintercept = seq(from = 0, to = 28, by = 4) + .5,
linetype = 'dashed', color = 'black') +
# ggtitle('From_WQin_To_Phylum_Complete, with Deinococcus.Thermus') +
ggtitle(
'Estimated effect of influent water quality on phylum abundance'
) +
xlab('Parameters') +
ylab('Estimated Values') +
scale_y_continuous(
limits = c(-.4,.4),
breaks = seq(from = -.4, to = .4, by = .1),
minor_breaks = seq(from = -.4, to = .4, by = .05)
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
)
# scale_y_continuous(
#     limits = c(-2,2),
#     breaks = seq(-3, 3, .5), minor_breaks = seq(-2, 2, .1))
if(0){
# ggsave('From_WQin_To_Phylum_Complete, with Deinococcus.Thermus.svg',
ggsave('From_WQin_To_Phylum_Complete, without Deinococcus.Thermus.svg',
device = 'svg', width = 16, height = 9)
}
}
#
print(
ggplot(data = dfm,
aes(x = variable, y = value, group = index)) +
geom_line(alpha = .13) +
geom_point(alpha = .13) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
geom_vline(xintercept = seq(from = 0, to = 28, by = 4) + .5,
linetype = 'dashed', color = 'black') +
# ggtitle('From_WQin_To_Phylum_Complete, with Deinococcus.Thermus') +
ggtitle(
'Estimated effect of influent water quality on phylum abundance'
) +
xlab('Parameters') +
ylab('Estimated Values') +
scale_y_continuous(
limits = c(-.04,.04),
breaks = seq(from = -.4, to = .4, by = .1),
minor_breaks = seq(from = -.4, to = .4, by = .05)
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
)
#
print(
ggplot(data = dfm,
aes(x = variable, y = value, group = index)) +
geom_line(alpha = .13) +
geom_point(alpha = .13) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
geom_vline(xintercept = seq(from = 0, to = 28, by = 4) + .5,
linetype = 'dashed', color = 'black') +
# ggtitle('From_WQin_To_Phylum_Complete, with Deinococcus.Thermus') +
ggtitle(
'Estimated effect of influent water quality on phylum abundance'
) +
xlab('Parameters') +
ylab('Estimated Values') +
scale_y_continuous(
limits = c(-.3,.3),
breaks = seq(from = -.4, to = .4, by = .1),
minor_breaks = seq(from = -.4, to = .4, by = .05)
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
)
# ggsave('From_WQin_To_Phylum_Complete, with Deinococcus.Thermus.svg',
ggsave('Effects.svg',
device = 'svg', width = 16, height = 9)
# ggsave('From_WQin_To_Phylum_Complete, with Deinococcus.Thermus.svg',
ggsave('Effects.svg',
device = 'svg')
